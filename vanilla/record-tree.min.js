var g=`record-tree\r
{\r
    display: block;\r
    --spacing: 7px;\r
    --indent: 20px;\r
}\r
\r
record-tree .collection\r
{\r
    border-radius: 3px;\r
    padding: var(--spacing);\r
    border: solid 1px transparent;\r
}\r
record-tree .collection:hover\r
{\r
    border-color: graytext;\r
}\r
\r
record-tree .collection > .collection\r
{\r
    margin-left: var(--indent);\r
    margin-block: var(--spacing);\r
}\r
\r
record-tree .collection > .property:first-of-type\r
{\r
    margin-top: var(--spacing);\r
}\r
record-tree .collection > .property\r
{\r
    margin-left: var(--indent);\r
}\r
record-tree .collection > .property:last-of-type\r
{\r
    margin-bottom: var(--spacing);\r
}\r
\r
record-tree .removed\r
{\r
    scale: .99;\r
    color: graytext;\r
}\r
\r
record-tree summary\r
{\r
    user-select: none;\r
    display: flex;\r
    gap: var(--spacing);\r
}\r
record-tree summary:before\r
{\r
    content: '\u25B6';\r
    transition: transform 100ms ease-out;\r
    font-size: .78em;\r
    align-self: center;\r
    margin-right: var(--spacing);\r
}\r
record-tree details[open] > summary:before\r
{\r
    transform: rotate(90deg);\r
}\r
record-tree summary .name\r
{\r
    flex: 1;\r
}\r
record-tree :not(.properties) > summary .name\r
{\r
    font-weight: bold;\r
    font-size: .8em;\r
}\r
\r
record-tree ul\r
{\r
    margin-block: var(--spacing);\r
    margin-left: var(--indent);\r
    padding: 0;\r
}\r
\r
record-tree .property\r
{\r
    user-select: none;\r
    display: flex;\r
    align-items: center;\r
    border-radius: 3px;\r
    border: solid 1px transparent;\r
}\r
record-tree .property:hover\r
{\r
    border-color: graytext;\r
}\r
\r
record-tree .property .name\r
{\r
    font-weight: bold;\r
    font-size: .8em;    \r
    text-align: right;\r
\r
    padding-left: var(--spacing);\r
    padding-block: var(--spacing);\r
    width: var(--property-name-width);\r
}\r
record-tree .property .value\r
{\r
    padding-inline: var(--spacing);\r
    padding-block: var(--spacing);\r
    flex: 1;\r
    overflow: hidden;\r
    text-overflow: ellipsis;\r
}\r
\r
record-tree button\r
{\r
    display: inline-flex;\r
    align-items: center;\r
    margin-left: auto;\r
    margin-right: var(--spacing);\r
}\r
\r
record-tree button .icon\r
{\r
    --size: 14px;\r
    width: var(--size);\r
    height: var(--size);\r
}`;var E=new CSSStyleSheet;E.replaceSync(g);var f="removed",m=`<svg class="icon cancel-cross" viewBox="0 0 22.812714 22.814663" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
    <path style="color:#000000;fill:var(--icon-primary-color,InfoText);stroke:var(--icon-secondary-color,InfoBackground);stroke-linecap:square;stroke-miterlimit:6.3;stroke-dashoffset:29.2913;stroke-opacity:1;-inkscape-stroke:none"
    d="m 1237.4389,207.63366 -1.8991,1.8987 a 0.65841136,0.65841136 90.003442 0 0 0,0.93116 l 0.4831,0.48317 a 14628.329,14628.329 44.999244 0 0 0.9312,0.93118 l 3.7936,3.79311 a 0.65840885,0.65840885 89.998393 0 1 0,0.93116 l -3.7936,3.7936 a 8783.6896,8783.6896 135.00442 0 1 -0.9313,0.93111 l -0.4829,0.48283 a 0.65811,0.65811 89.993977 0 0 10e-5,0.93094 l 1.8987,1.89741 a 0.65867085,0.65867085 179.98891 0 0 0.9314,-1.8e-4 l 0.4826,-0.48267 a 45427.77,45427.77 134.99941 0 1 0.9312,-0.93119 l 3.7931,-3.79308 a 0.65848899,0.65848899 179.99848 0 1 0.9312,-2e-5 l 3.7936,3.79312 a 10110.91,10110.91 44.992994 0 0 0.9313,0.93108 l 0.483,0.48285 a 0.65856615,0.65856615 179.99438 0 0 0.9313,-9e-5 l 1.897,-1.89705 a 0.65833101,0.65833101 89.994378 0 0 -10e-5,-0.93111 l -0.483,-0.48285 a 5293.5057,5293.5057 44.99639 0 1 -0.9313,-0.93113 l -3.793,-3.79354 a 0.65849247,0.65849247 90.001607 0 1 0,-0.93122 l 3.793,-3.79305 a 149190.44,149190.44 134.99995 0 1 0.9312,-0.93119 l 0.4832,-0.48321 a 0.65863247,0.65863247 90.008202 0 0 10e-5,-0.93132 l -1.8972,-1.89834 a 0.65838576,0.65838576 0.01346964 0 0 -0.9312,-2.2e-4 l -0.483,0.48285 a 7148.543,7148.543 135.00546 0 0 -0.9313,0.9311 l -3.7936,3.79359 a 0.65841791,0.65841791 0.00151591 0 1 -0.9312,-3e-5 l -3.7931,-3.79353 a 52707.551,52707.551 45.002134 0 0 -0.9312,-0.93122 l -0.4826,-0.48267 a 0.65849044,0.65849044 0.00323988 0 0 -0.9312,-5e-5 z"
    transform="translate(-1232.6358,-204.72848)" />
</svg>`,b=`<svg class="icon cancel-cross" viewBox="0 0 22.812714 22.814663" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
    <path style="color:#000000;fill:var(--icon-primary-color,InfoText);stroke:var(--icon-secondary-color,InfoBackground);stroke-linecap:square;stroke-miterlimit:6.3;stroke-dashoffset:29.2913;stroke-opacity:1;-inkscape-stroke:none"
    d="m 1237.4389,207.63366 -1.8991,1.8987 a 0.65841136,0.65841136 90.003442 0 0 0,0.93116 l 0.4831,0.48317 a 14628.329,14628.329 44.999244 0 0 0.9312,0.93118 l 3.7936,3.79311 a 0.65840885,0.65840885 89.998393 0 1 0,0.93116 l -3.7936,3.7936 a 8783.6896,8783.6896 135.00442 0 1 -0.9313,0.93111 l -0.4829,0.48283 a 0.65811,0.65811 89.993977 0 0 10e-5,0.93094 l 1.8987,1.89741 a 0.65867085,0.65867085 179.98891 0 0 0.9314,-1.8e-4 l 0.4826,-0.48267 a 45427.77,45427.77 134.99941 0 1 0.9312,-0.93119 l 3.7931,-3.79308 a 0.65848899,0.65848899 179.99848 0 1 0.9312,-2e-5 l 3.7936,3.79312 a 10110.91,10110.91 44.992994 0 0 0.9313,0.93108 l 0.483,0.48285 a 0.65856615,0.65856615 179.99438 0 0 0.9313,-9e-5 l 1.897,-1.89705 a 0.65833101,0.65833101 89.994378 0 0 -10e-5,-0.93111 l -0.483,-0.48285 a 5293.5057,5293.5057 44.99639 0 1 -0.9313,-0.93113 l -3.793,-3.79354 a 0.65849247,0.65849247 90.001607 0 1 0,-0.93122 l 3.793,-3.79305 a 149190.44,149190.44 134.99995 0 1 0.9312,-0.93119 l 0.4832,-0.48321 a 0.65863247,0.65863247 90.008202 0 0 10e-5,-0.93132 l -1.8972,-1.89834 a 0.65838576,0.65838576 0.01346964 0 0 -0.9312,-2.2e-4 l -0.483,0.48285 a 7148.543,7148.543 135.00546 0 0 -0.9313,0.9311 l -3.7936,3.79359 a 0.65841791,0.65841791 0.00151591 0 1 -0.9312,-3e-5 l -3.7931,-3.79353 a 52707.551,52707.551 45.002134 0 0 -0.9312,-0.93122 l -0.4826,-0.48267 a 0.65849044,0.65849044 0.00323988 0 0 -0.9312,-5e-5 z"
    transform="translate(-1232.6358,-204.72848)" />
</svg>`,y="record-tree",h=class extends HTMLElement{static observedAttributes=[];#t;path=[];#n=new Set;#r=new Array;#a=new Array;#e=new Array;#s=new Array;#i=new Array;#o=0;constructor(){super(),this.getRootNode().adoptedStyleSheets.push(E),this.addEventListener("click",this.#l.bind(this))}#l(t){let e=t.target.closest("svg")!=null?t.target.closest("button"):t.target;if(e==null||!e.classList.contains("remove"))return;let a=e.parentElement?.classList.contains("property")?e.parentElement:e.parentElement?.parentElement?.classList.contains("collection")?e.parentElement.parentElement:null;if(a==null){console.error("Unknown button clicked");return}if(t.stopPropagation(),t.preventDefault(),this.hasAttribute("removed-class")){let n=this.getAttribute("removed-class");(n==null||n=="")&&(n=f),a.classList.contains(n)?(a.classList.remove(n),a.dataset.path!=".properties"&&this.#n.delete(a.dataset.path),e.innerHTML=m,e.title="Remove",this.dispatchEvent(new CustomEvent("restore",{detail:{path:a.dataset.path}}))):(a.classList.add(n),a.dataset.path!=".properties"&&this.#n.add(a.dataset.path),e.innerHTML=b,e.title="Undo",e.classList.add("undo"),this.dispatchEvent(new CustomEvent("remove",{detail:{path:a.dataset.path}})))}else a.remove(),this.#n.add(a.dataset.path),this.dispatchEvent(new CustomEvent("remove",{detail:{path:a.dataset.path}}))}getPathArray(){return this.path}getCurrentPathString(){return this.path.join(".")}getInitialData(){return this.#t}setData(t){this.#t=t,this.renderRecordData(this.#t)}async renderRecordData(t){this.innerHTML="",this.path=[],await this.renderData(t,this),this.path=[],this.style.setProperty("--property-name-width",`${this.#o}px`)}async renderData(t,e,a=!0){let n=this.path[this.path.length-1]??this.getAttribute("parent-name")??"Data";if(Array.isArray(t)){let s=this.renderArrayAsCollection;for(let r=0;r<this.#r.length;r++)if(this.#r[r].condition(n,t,e)==!0){s=this.#r[r].renderer;break}await s.call(this,n,t,e)}else if(Object.prototype.toString.call(t)==="[object Object]"){t=this.draftObject(t);let s=this.renderObjectAsCollection;for(let r=0;r<this.#a.length;r++)if(this.#a[r].condition(n,t,e)==!0){s=this.#a[r].renderer;break}await s.call(this,n,t,e)}else if(a==!0){let s=this.path.filter((p,d)=>d<this.path.length-1),r=this.querySelector(`details[data-path="${s.join(".")}.properties"]`),i=r==null?null:r.querySelector("ul"),o=null;r==null&&(o=this.createCollectionDetailsElement("Properties",`${s.join(".")}.properties`,["collection","properties"],!1),o.toggleAttribute("open",!0),i=document.createElement("ul"),o.append(i),e.append(o)),i.children.length>10&&o.toggleAttribute("open",!1);let c=this.renderObjectProperty;for(let p=0;p<this.#e.length;p++)if(this.#e[p].condition(n,t,i)==!0){c=this.#e[p].renderer;break}await c.call(this,n,t,i)}else{let s=this.renderObjectProperty;for(let r=0;r<this.#e.length;r++)if(this.#e[r].condition(n,t,e)==!0){s=this.#e[r].renderer;break}await s.call(this,n,t,e)}}addCustomCollectionRenderer(t,e){this.#r.push({condition:t,renderer:e})}addCustomObjectRenderer(t,e){this.#a.push({condition:t,renderer:e})}addCustomPropertyRenderer(t,e){this.#e.push({condition:t,renderer:e})}addCustomPropertyNameGenerator(t,e){this.#s.push({condition:t,generator:e})}addCustomPropertyValueGenerator(t,e){this.#i.push({condition:t,generator:e})}clear(){this.innerHTML=""}refresh(){this.setData(this.#t)}getUpdatedData(){let t=structuredClone(this.#t);for(let[e]of this.#n.entries()){let a=e.split("."),n=t,s=t[a[0]],r=a[0];for(let i=1;i<a.length;i++)r=a[i],n=s,s=n[r];n!=null&&s!=null&&delete n[r]}return t}createCollectionDetailsElement(t,e,a,n){let s=document.createElement("details");a!=null&&s.classList.add(...a),s.setAttribute("data-path",e);let r=document.createElement("summary"),i=document.createElement("span");if(i.textContent=t,i.classList.add("name"),r.append(i),n!=!1){let o=document.createElement("button");o.innerHTML=m,o.title="Remove",o.classList.add("remove"),r.append(o)}return s.append(r),s}async renderArrayAsCollection(t,e,a){let n=isNaN(parseInt(t))?t:`[${t}]`,s=this.createCollectionDetailsElement(n,this.path.join("."),["collection"]);this.path.length==0&&s.setAttribute("open",""),a.append(s);for(let r=0;r<e.length;r++)this.path.push(r.toString()),await this.renderData(e[r],s,!1),this.path.pop()}async renderObjectAsCollection(t,e,a){let n=isNaN(parseInt(t))?t:e.name!=null&&e.name.trim()!=""?e.name:e.description!=null&&e.description.trim()!=""?e.description:e.key!=null&&e.key.trim()!=""?e.key:e.id!=null&&e.id.toString().trim()!=""?e.id:`[${t}]`,s=this.createCollectionDetailsElement(n,this.path.join("."),["collection"]);this.path.length==0&&s.setAttribute("open",""),a.append(s);for(let[r,i]of Object.entries(e))this.path.push(r),await this.renderData(e[r],s),this.path.pop()}async renderObjectProperty(t,e,a){let n=a instanceof HTMLUListElement?"li":"div",s=document.createElement(n);s.classList.add("property"),s.dataset.path=this.path.join(".");let r=this.createPropertyName;for(let l=0;l<this.#s.length;l++)if(this.#s[l].condition(t,e,a)==!0){r=this.#s[l].generator;break}let i=await r(t,e,a),o=document.createElement("span");o.classList.add("delimiter"),o.textContent=":";let c=this.createPropertyValue.bind(this);for(let l=0;l<this.#i.length;l++)if(this.#i[l].condition(t,e,a)==!0){c=this.#i[l].generator;break}let p=await c(t,e,a),d=document.createElement("button");d.innerHTML=m,d.title="Remove",d.classList.add("remove"),s.append(i,o,p,d),s.title=`${i.getAttribute("title")}: ${p.getAttribute("title")}`,a.append(s);let u=Math.ceil(i.getBoundingClientRect().width);this.#o<u&&(this.#o=u)}createPropertyName(t,e,a){let n=document.createElement("span");return n.classList.add("name"),n.textContent=t,n.title=t,n}createPropertyValue(t,e,a){let n=document.createElement("span");return n.classList.add("value"),e===void 0?e=this.getAttribute("undefined-value")??"[ undefined ]":e===null?e=this.getAttribute("null-value")??"[ null ]":e=e.toString(),e.trim()==""&&(e=this.getAttribute("blank-value")??"[ blank text ]"),n.textContent=e.length>1024?e.substring(0,1024):e,n.title=e.startsWith("data:")?"[ Binary Data ]":e,n}async renderCollectionAsKeyValuePairs(t,e,a){let n=this.createCollectionDetailsElement(t,this.path.join("."),["collection","key-value-pairs"]),s=document.createElement("ul");n.append(s);for(let r=0;r<e.length;r++)this.path.push(e[r].key),await this.renderObjectProperty(e[r].key,e[r].value,s),this.path.pop();a.append(n)}async renderCollectionAsValues(t,e,a){let n=this.createCollectionDetailsElement(t,this.path.join("."),["collection","values"]),s=document.createElement("ul");n.append(s);for(let r=0;r<e.length;r++)this.path.push(e[r]),await this.renderObjectAsValue(e[r],e[r],s),this.path.pop();a.append(n)}async renderObjectAsValue(t,e,a){let n=document.createElement("li");n.classList.add("property"),n.dataset.path=this.path.join(".");let s=document.createElement("span");s.classList.add("value"),s.textContent=e.toString(),s.title="[ Object ]";let r=document.createElement("button");r.innerHTML=m,r.title="Remove",r.classList.add("remove"),n.append(s,r),a.append(n)}renderDataObject(t,e){if(Array.isArray(t))for(let a=0;a<t.length;a++){let n=t[a],s=document.createElement("details"),r=document.createElement("summary"),i=n.name??n.description??n.key;(i==null||i.trim()=="")&&(i=a.toString()),r.classList.add("property"),r.textContent=i.substring(0,Math.min(i.length,20)),s.classList.add("subrecord"),e.appendChild(s),s.appendChild(r),this.renderDataObject(n,s)}else{let a=null;for(let[n,s]of Object.entries(t))if(Array.isArray(s)||Object.prototype.toString.call(s)==="[object Object]"){let r=document.createElement("details"),i=document.createElement("summary");i.classList.add("property"),i.textContent=n,r.classList.add("subrecord"),e.appendChild(r),r.appendChild(i),this.renderDataObject(s,r)}else{a==null&&(a=e.querySelector(":scope > ul"),a==null&&(a=document.createElement("ul"),e.appendChild(a)));let r=document.createElement("li");r.classList.add("property");let i=document.createElement("span");i.classList.add("name"),i.textContent=n;let o=document.createElement("span");o.classList.add("value");let c=s.toString();o.textContent=c.substring(0,Math.min(c.length,20)),r.append(i,o),a.append(r)}}}draftObject(t){return Object.assign({},t,this.extractProperties(t))}extractProperties(t){let e=this.getPropertyNames(t),a={};for(let n=0;n<e.length;n++)a[e[n]]=t[e[n]];return a}getPropertyNames(t){let e=Reflect.getPrototypeOf(t),a=Object.getOwnPropertyDescriptors(e);return Object.entries(a).filter(n=>typeof n[1].get=="function"&&n[0]!=="__proto__").map(n=>n[0])}};customElements.get(y)==null&&customElements.define(y,h);export{h as RecordTreeElement};
