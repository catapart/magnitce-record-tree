var y=`record-tree
{
    display: block;
    --spacing: 7px;
    --indent: 20px;
}

record-tree .collection
{
    border-radius: 3px;
    padding: var(--spacing);
    border: solid 1px transparent;
}
record-tree .collection:hover
{
    border-color: graytext;
}

record-tree .collection > .collection
{
    margin-left: var(--indent);
    margin-block: var(--spacing);
}

record-tree .collection > .property:first-of-type
{
    margin-top: var(--spacing);
}
record-tree .collection > .property
{
    margin-left: var(--indent);
}
record-tree .collection > .property:last-of-type
{
    margin-bottom: var(--spacing);
}

record-tree .removed
{
    scale: .99;
    color: graytext;
}

record-tree summary
{
    user-select: none;
    display: flex;
    gap: var(--spacing);
}
record-tree summary:before
{
    content: '\u25B6';
    transition: transform 100ms ease-out;
    font-size: .78em;
    align-self: center;
    margin-right: var(--spacing);
}
record-tree details[open] > summary:before
{
    transform: rotate(90deg);
}
record-tree summary .name
{
    flex: 1;
}
record-tree :not(.properties) > summary .name
{
    font-weight: bold;
    font-size: .8em;
}

record-tree ul
{
    margin-block: var(--spacing);
    margin-left: var(--indent);
    padding: 0;
}

record-tree .property
{
    user-select: none;
    display: flex;
    align-items: center;
    border-radius: 3px;
    border: solid 1px transparent;
}
record-tree .property:hover
{
    border-color: graytext;
}

record-tree .property .name
{
    font-weight: bold;
    font-size: .8em;    
    text-align: right;

    padding-left: var(--spacing);
    padding-block: var(--spacing);
    width: var(--property-name-width);
}
record-tree .property .value
{
    padding-inline: var(--spacing);
    padding-block: var(--spacing);
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
}

record-tree button
{
    display: inline-flex;
    align-items: center;
    margin-left: auto;
    margin-right: var(--spacing);
}

record-tree button .icon
{
    --size: 14px;
    width: var(--size);
    height: var(--size);
}`;var E=new CSSStyleSheet;E.replaceSync(y);var v="removed",m=`<svg class="icon cancel-cross" part="icon cross remove-icon" viewBox="0 0 22.812714 22.814663" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
    <path style="color:#000000;fill:var(--icon-primary-color,InfoText);stroke:var(--icon-secondary-color,InfoBackground);stroke-linecap:square;stroke-miterlimit:6.3;stroke-dashoffset:29.2913;stroke-opacity:1;-inkscape-stroke:none"
    d="m 1237.4389,207.63366 -1.8991,1.8987 a 0.65841136,0.65841136 90.003442 0 0 0,0.93116 l 0.4831,0.48317 a 14628.329,14628.329 44.999244 0 0 0.9312,0.93118 l 3.7936,3.79311 a 0.65840885,0.65840885 89.998393 0 1 0,0.93116 l -3.7936,3.7936 a 8783.6896,8783.6896 135.00442 0 1 -0.9313,0.93111 l -0.4829,0.48283 a 0.65811,0.65811 89.993977 0 0 10e-5,0.93094 l 1.8987,1.89741 a 0.65867085,0.65867085 179.98891 0 0 0.9314,-1.8e-4 l 0.4826,-0.48267 a 45427.77,45427.77 134.99941 0 1 0.9312,-0.93119 l 3.7931,-3.79308 a 0.65848899,0.65848899 179.99848 0 1 0.9312,-2e-5 l 3.7936,3.79312 a 10110.91,10110.91 44.992994 0 0 0.9313,0.93108 l 0.483,0.48285 a 0.65856615,0.65856615 179.99438 0 0 0.9313,-9e-5 l 1.897,-1.89705 a 0.65833101,0.65833101 89.994378 0 0 -10e-5,-0.93111 l -0.483,-0.48285 a 5293.5057,5293.5057 44.99639 0 1 -0.9313,-0.93113 l -3.793,-3.79354 a 0.65849247,0.65849247 90.001607 0 1 0,-0.93122 l 3.793,-3.79305 a 149190.44,149190.44 134.99995 0 1 0.9312,-0.93119 l 0.4832,-0.48321 a 0.65863247,0.65863247 90.008202 0 0 10e-5,-0.93132 l -1.8972,-1.89834 a 0.65838576,0.65838576 0.01346964 0 0 -0.9312,-2.2e-4 l -0.483,0.48285 a 7148.543,7148.543 135.00546 0 0 -0.9313,0.9311 l -3.7936,3.79359 a 0.65841791,0.65841791 0.00151591 0 1 -0.9312,-3e-5 l -3.7931,-3.79353 a 52707.551,52707.551 45.002134 0 0 -0.9312,-0.93122 l -0.4826,-0.48267 a 0.65849044,0.65849044 0.00323988 0 0 -0.9312,-5e-5 z"
    transform="translate(-1232.6358,-204.72848)" />
</svg>`,f=`<svg class="icon undo-redo" part="icon undo-redo-icon" viewBox="0 0 22.812714 22.814663" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
<path
   style="color:#000000;fill:var(--icon-primary-color,InfoText);stroke:var(--icon-secondary-color,CanvasText);fill-opacity:1;stroke-width:0.999999;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1"
   d="M 8.7359009 1.1063924 C 8.3768905 1.0950243 8.0017196 1.1736712 7.641394 1.3523722 L 1.6107544 6.1205566 L 1.5916341 6.1386434 L 1.53479 6.1939372 C 1.0620233 6.6537208 0.70744486 7.6004515 1.0769368 8.152474 L 5.3030355 14.40894 C 6.1798306 15.219356 7.5994445 15.083541 8.4749349 14.106116 C 9.2135837 13.277519 9.3398045 12.086041 8.7787923 11.23549 L 11.334192 11.410673 C 14.129266 11.815808 17.330477 13.067707 18.931144 18.826241 C 19.313756 19.953163 19.735424 21.309718 20.245793 22.173324 C 20.976132 22.497497 21.420713 20.679238 21.478792 18.791101 C 21.506716 14.251463 18.262689 8.6142076 13.845667 6.7716797 C 13.291103 6.5403477 11.805521 5.8978235 10.30118 5.3355916 L 9.7994019 5.1107992 C 10.609379 4.4184442 10.916638 3.2966427 10.55026 2.3703979 C 10.238366 1.5905459 9.5257236 1.1314023 8.7359009 1.1063924 z " />
</svg>`,g="record-tree",u=class extends HTMLElement{static observedAttributes=[];#t;path=[];#r=new Set;#n=new Array;#a=new Array;#e=new Array;#o=new Array;#i=new Array;#s=0;constructor(){super(),this.getRootNode().adoptedStyleSheets.push(E),this.addEventListener("click",this.#l.bind(this))}#l(n){let e=n.target.closest("svg")!=null?n.target.closest("button"):n.target;if(e==null||!e.classList.contains("remove"))return;let a=e.parentElement?.classList.contains("property")?e.parentElement:e.parentElement?.parentElement?.classList.contains("collection")?e.parentElement.parentElement:null;if(a==null){console.error("Unknown button clicked");return}if(n.stopPropagation(),n.preventDefault(),this.hasAttribute("removed-class")){let r=this.getAttribute("removed-class");(r==null||r=="")&&(r=v),a.classList.contains(r)?(a.classList.remove(r),a.part.remove(r),a.dataset.path!=".properties"&&this.#r.delete(a.dataset.path),e.innerHTML=m,e.title="Remove",e.classList.remove("undo"),e.part.remove("undo"),this.dispatchEvent(new CustomEvent("restore",{detail:{path:a.dataset.path}}))):(a.classList.add(r),a.part.add(r),a.dataset.path!=".properties"&&this.#r.add(a.dataset.path),e.innerHTML=f,e.title="Undo",e.classList.add("undo"),e.part.add("undo"),this.dispatchEvent(new CustomEvent("remove",{detail:{path:a.dataset.path}})))}else a.remove(),this.#r.add(a.dataset.path),this.dispatchEvent(new CustomEvent("remove",{detail:{path:a.dataset.path}}))}getPathArray(){return this.path}getCurrentPathString(){return this.path.join(".")}getInitialData(){return this.#t}setData(n){this.#t=n,this.renderRecordData(this.#t)}async renderRecordData(n){this.innerHTML="",this.path=[],await this.renderData(n,this),this.path=[],this.style.setProperty("--property-name-width",`${this.#s}px`)}async renderData(n,e,a=!0){let r=this.path[this.path.length-1]??this.getAttribute("parent-name")??"Data";if(Array.isArray(n)){let o=this.renderArrayAsCollection;for(let t=0;t<this.#n.length;t++)if(this.#n[t].condition(r,n,e)==!0){o=this.#n[t].renderer;break}await o.call(this,r,n,e,!0)}else if(Object.prototype.toString.call(n)==="[object Object]"){n=this.draftObject(n);let o=this.renderObjectAsCollection;for(let t=0;t<this.#a.length;t++)if(this.#a[t].condition(r,n,e)==!0){o=this.#a[t].renderer;break}await o.call(this,r,n,e,!0)}else if(a==!0){let o=this.path.filter((l,c)=>c<this.path.length-1),t=this.querySelector(`details[data-path="${o.join(".")}.properties"]`),i=t==null?null:t.querySelector("ul");t==null&&(t=this.createCollectionDetailsElement("Properties",`${o.join(".")}.properties`,["collection","properties"],!1),t.toggleAttribute("open",!0),i=document.createElement("ul"),i.classList.add("properties-list"),i.part.add("properties-list"),t.append(i),e.append(t)),i.children.length>10&&t.toggleAttribute("open",!1);let s=this.renderObjectProperty;for(let l=0;l<this.#e.length;l++)if(this.#e[l].condition(r,n,i)==!0){s=this.#e[l].renderer;break}await s.call(this,r,n,i)}else{let o=this.renderObjectProperty;for(let t=0;t<this.#e.length;t++)if(this.#e[t].condition(r,n,e)==!0){o=this.#e[t].renderer;break}await o.call(this,r,n,e)}}addCustomCollectionRenderer(n,e){this.#n.push({condition:n,renderer:e})}addCustomObjectRenderer(n,e){this.#a.push({condition:n,renderer:e})}addCustomPropertyRenderer(n,e){this.#e.push({condition:n,renderer:e})}addCustomPropertyNameGenerator(n,e){this.#o.push({condition:n,generator:e})}addCustomPropertyValueGenerator(n,e){this.#i.push({condition:n,generator:e})}clear(){this.innerHTML=""}refresh(){this.setData(this.#t)}getUpdatedData(){let n=structuredClone(this.#t);for(let[e]of this.#r.entries()){let a=e.split("."),r=n,o=n[a[0]],t=a[0];for(let i=1;i<a.length;i++)t=a[i],r=o,o=r[t];r!=null&&o!=null&&delete r[t]}return n}createCollectionDetailsElement(n,e,a,r,o){let t=document.createElement("details");a!=null&&(t.classList.add("details",...a),t.part.add("details",...a)),t.setAttribute("data-path",e);let i=document.createElement("summary");i.classList.add("summary"),i.part.add("summary","collection",...a??[]),o!=null&&o==!0&&i.part.add("top");let s=document.createElement("span");if(s.textContent=n,s.classList.add("name"),s.part.add("name","collection",...a??[]),i.append(s),r!=!1){let l=document.createElement("button");l.innerHTML=m,l.title="Remove",l.classList.add("button","icon-button","remove"),l.part.add("button","icon-button","remove"),i.append(l)}return t.append(i),t}async renderArrayAsCollection(n,e,a,r=!1){let o=isNaN(parseInt(n))?n:`[${n}]`,t=this.createCollectionDetailsElement(o,this.path.join("."),["collection"],void 0,r);this.path.length==0&&t.setAttribute("open",""),r==!0&&(t.classList.add("top"),t.part.add("top")),a.append(t);for(let i=0;i<e.length;i++)this.path.push(i.toString()),await this.renderData(e[i],t,!1),this.path.pop()}async renderObjectAsCollection(n,e,a,r=!1){let o=isNaN(parseInt(n))?n:e.name!=null&&e.name.trim()!=""?e.name:e.description!=null&&e.description.trim()!=""?e.description:e.key!=null&&e.key.trim()!=""?e.key:e.id!=null&&e.id.toString().trim()!=""?e.id:`[${n}]`,t=this.createCollectionDetailsElement(o,this.path.join("."),["collection"],void 0,r);this.path.length==0&&t.setAttribute("open",""),r==!0&&(t.classList.add("top"),t.part.add("top")),a.append(t);for(let[i,s]of Object.entries(e))this.path.push(i),await this.renderData(e[i],t),this.path.pop()}async renderObjectProperty(n,e,a){let r=a instanceof HTMLUListElement?"li":"div",o=document.createElement(r);o.classList.add("property"),o.part.add("property"),o.dataset.path=this.path.join(".");let t=this.createPropertyName;for(let d=0;d<this.#o.length;d++)if(this.#o[d].condition(n,e,a)==!0){t=this.#o[d].generator;break}let i=await t(n,e,a),s=document.createElement("span");s.classList.add("delimiter"),s.part.add("delimiter"),s.textContent=":";let l=this.createPropertyValue.bind(this);for(let d=0;d<this.#i.length;d++)if(this.#i[d].condition(n,e,a)==!0){l=this.#i[d].generator;break}let c=await l(n,e,a),p=document.createElement("button");p.innerHTML=m,p.title="Remove",p.classList.add("button","icon-button","remove"),p.part.add("button","icon-button","remove"),o.append(i,s,c,p),o.title=`${i.getAttribute("title")}: ${c.getAttribute("title")}`,a.append(o);let h=Math.ceil(i.getBoundingClientRect().width);this.#s<h&&(this.#s=h)}createPropertyName(n,e,a){let r=document.createElement("span");return r.classList.add("name"),r.part.add("name","property-name"),r.textContent=n,r.title=n,r}createPropertyValue(n,e,a){let r=document.createElement("span");return r.classList.add("value"),r.part.add("value","value"),e===void 0?(e=this.getAttribute("undefined-value")??"[ undefined ]",r.classList.add("undefined"),r.part.add("undefined")):e===null?(e=this.getAttribute("null-value")??"[ null ]",r.classList.add("null"),r.part.add("null")):e=e.toString(),e.trim()==""&&(e=this.getAttribute("blank-value")??"[ blank text ]"),r.textContent=e.length>1024?e.substring(0,1024):e,r.title=e.startsWith("data:")?"[ Binary Data ]":e,r}async renderCollectionAsKeyValuePairs(n,e,a){let r=this.createCollectionDetailsElement(n,this.path.join("."),["collection","key-value-pairs"]),o=document.createElement("ul");o.part.add("properties-list"),r.append(o);for(let t=0;t<e.length;t++)this.path.push(e[t].key),await this.renderObjectProperty(e[t].key,e[t].value,o),this.path.pop();a.append(r)}async renderCollectionAsValues(n,e,a){let r=this.createCollectionDetailsElement(n,this.path.join("."),["collection","values"]),o=document.createElement("ul");o.part.add("properties-list"),r.append(o);for(let t=0;t<e.length;t++)this.path.push(e[t]),await this.renderObjectAsValue(e[t],e[t],o),this.path.pop();a.append(r)}async renderObjectAsValue(n,e,a){let r=document.createElement("li");r.classList.add("property"),r.part.add("property"),r.dataset.path=this.path.join(".");let o=document.createElement("span");o.classList.add("value"),o.part.add("value"),o.textContent=e.toString(),o.title="[ Object ]";let t=document.createElement("button");t.innerHTML=m,t.title="Remove",t.classList.add("button","icon-button","remove"),t.part.add("button","icon-button","remove"),r.append(o,t),a.append(r)}renderDataObject(n,e){if(Array.isArray(n))for(let a=0;a<n.length;a++){let r=n[a],o=document.createElement("details"),t=document.createElement("summary"),i=r.name??r.description??r.key;(i==null||i.trim()=="")&&(i=a.toString()),t.classList.add("summary"),t.part.add("summary","property"),t.textContent=i.substring(0,Math.min(i.length,20)),o.classList.add("subrecord"),o.part.add("subrecord"),e.appendChild(o),o.appendChild(t),this.renderDataObject(r,o)}else{let a=null;for(let[r,o]of Object.entries(n))if(Array.isArray(o)||Object.prototype.toString.call(o)==="[object Object]"){let t=document.createElement("details"),i=document.createElement("summary");i.classList.add("summary"),i.part.add("summary","property"),i.textContent=r,t.classList.add("subrecord"),t.part.add("subrecord"),e.appendChild(t),t.appendChild(i),this.renderDataObject(o,t)}else{a==null&&(a=e.querySelector(":scope > ul"),a==null&&(a=document.createElement("ul"),a.classList.add("properties-list"),a.part.add("properties-list"),e.appendChild(a)));let t=document.createElement("li");t.classList.add("property"),t.part.add("property");let i=document.createElement("span");i.classList.add("name"),i.part.add("name","property-name"),i.textContent=r;let s=document.createElement("span");s.classList.add("value"),s.part.add("value","property-value");let l=o.toString();s.textContent=l.substring(0,Math.min(l.length,20)),t.append(i,s),a.append(t)}}}draftObject(n){return Object.assign({},n,this.extractProperties(n))}extractProperties(n){let e=this.getPropertyNames(n),a={};for(let r=0;r<e.length;r++)a[e[r]]=n[e[r]];return a}getPropertyNames(n){let e=Reflect.getPrototypeOf(n),a=Object.getOwnPropertyDescriptors(e);return Object.entries(a).filter(r=>typeof r[1].get=="function"&&r[0]!=="__proto__").map(r=>r[0])}};customElements.get(g)==null&&customElements.define(g,u);export{u as RecordTreeElement};
